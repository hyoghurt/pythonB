from bs4 import BeautifulSoup

#1
with open("./evilcorp.html", "r") as f:
    soup = BeautifulSoup(f, 'html.parser')

#2
soup.title.string.replace_with("Evil Corp - Stealing your money every day")

#3
newTag = soup.new_tag("h1")
newTag.string = soup.p.span.text + ', you are hacked!'

soup.body.insert(2, '\r\n')
soup.body.insert(3, newTag)

#4
newTag = soup.new_tag("script")
newTag.string = '''
hacked = function() {
    alert('hacked');
}
window.addEventListener('load',
    function() {
        var f = document.querySelector("form");
        f.setAttribute("onsubmit", "hacked()");
    },
    false
);
'''
soup.body.append(newTag)
soup.body.append('\r\n')

#5
soup.find(href=True)['href'] = 'https://mrrobot.fandom.com/wiki/Fsociety'

with open("./evilcorp_hacked.html", "w+") as fw:
    fw.write(str(soup))
